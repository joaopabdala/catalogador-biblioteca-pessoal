<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Página Inicial</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <script src="../jquery/jquery.min.js"></script>
    <link rel="stylesheet" href="../style.css">
</head>

<body class="bg-primary">
    <header id="nav-desktop">

    </header>

    <div class="bg-secondary py-4 d-flex flex-column flex-md-row">
        <div class="col col-sm-3 mx-4 d-flex flex-column align-items-center">
            <h5 class="mb-3 d-block d-md-none"> <strong><span id="book-name"></span></strong> <br> <span id="author">
                </span></h5>

            <img src="" alt="" class="book-cover-description" id="book-cover">
        </div>
        <div class="col mt-3 d-flex flex-column align-items-center d-flex d-md-none">
            <button class="btn bg-primary text-white add-shelf">Adicionar a sua estante</button>

        </div>
        <div class="col mx-5 mt-4">

            <h3 class="mb-5 d-none d-md-flex"><strong><span id="book-name2"></span></strong>&nbsp- &nbsp<span
                    id="author2"> </span></h3>
            <p class="mb-3"> Description: <span id="description"></span></p>
            <p>Pages: <span id="pages"></span></p>
            <p>ISBN: <span id="isbn"></span></p>
            <button class="btn bg-primary text-white d-none d-md-block add-shelf" name="shelf" value="">Adicionar a
                sua estante</button>
        </div>

    </div>

    <footer id="nav-mobile">

    </footer>



    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
        crossorigin="anonymous"></script>

    <script src="../model/navLogic2.js"></script>

    <script>
        var urlParams = new URLSearchParams(window.location.search);

        var idGet = urlParams.get('id');

        let storedArray = JSON.parse(localStorage.getItem('shelf')) || [];

        if (storedArray.includes(idGet)) {
            $('.add-shelf').text('Livro já está na estante').attr('class', 'btn bg-primary text-danger d-none d-md-block add-shelf')
        }

        $('.add-shelf').attr('value', idGet);
        $('.add-shelf').on('click', function (event) {



            if (!storedArray.includes(idGet)) {
                storedArray.push(idGet);
            }

            localStorage.setItem('shelf', JSON.stringify(storedArray));

            $('.add-shelf').text('Livro já está na estante').attr('class', 'btn bg-primary text-danger d-none d-md-block add-shelf')

        })

        $.ajax({
            url: 'http://localhost:3000/livros/',
            data: {
                id: idGet
            },
            success(data) {
                $('#book-name').text(data[0].title)
                $('#author').text(data[0].author)
                $('#book-name2').text(data[0].title)
                $('#author2').text(data[0].author)
                $('#description').text(data[0].description)
                $('#pages').text(data[0].pages)
                $('#isbn').text(data[0].ISBN)
                $('#book-cover').attr("src", data[0].cover)
            }
        }
        )






    </script>
</body>

</html>